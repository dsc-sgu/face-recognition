# Приложение на C++ для детектирования лиц (#3)

- [x] На изображении
- [x] На видеопотоке

Необходимо установить библиотеки [OpenCV](https://docs.opencv.org/4.7.0/d7/d9f/tutorial_linux_install.html) и [LibTorch](https://pytorch.org/get-started/locally/).

## Подробности

Для использования обученной модели с помощью LibTorch достаточно экспортировать ее в формат `torchscript` с помощью модуля `ultralytics`:

```python
from ultralytics import YOLO
model = YOLO('yolov8n-face.pt')
model.export(format='torchscript')
```

Выходы модели представляют из себя кортеж из тензора с шейпом `(1, 5, 8400)` и кортежа с детектированиями по сеткам. Первый тензор имеет особую важность, на его основе и проводится обработка боксов детектирования в этом приложении: 4 субтензора содержат нормализованные *cx*, *cy*, *w*, *h* координаты соответственно, 5 субтензор содержит уверенности модели в валидности соответствующего бокса — *conf*.

У меня возникли проблемы с установкой `TorchVision`, откуда можно было взять функцию для **Non Maximum Supression**, поэтому я прописал ее сам.
